---
import Base from "../../layouts/Base.astro";
import { getCollection } from "astro:content";

const posts = await getCollection("blog");

const categories = [...new Set(
  posts
    .map((p) => p.data.category?.trim())
    .filter(Boolean)
)];

const title = "Categories";
---

<Base title={title}>
  <section style="padding: 3rem 1rem; text-align:center;">
    <h1 style="font-size:2rem; font-weight:700;">{title}</h1>

    <ul style="list-style:none; padding:0; margin-top:2rem;">
      {categories.map((cat) => {
        const slug = cat
  .toLowerCase()
  .normalize("NFD")
  .replace(/[\u0300-\u036f]/g, "")
  .replace(/\s+/g, "-")
  .replace(/[^a-z0-9-]/g, "")
  .replace(/-+/g, "-");
        return (
          <li style="margin: 0.5rem 0;">
            <a href={`/categories/${slug}/`} style="color: var(--accent); font-weight:600;">
              {cat}
            </a>
          </li>
        );
      })}
    </ul>
  </section>
</Base>
