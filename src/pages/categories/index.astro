---
import Base from "../layouts/Base.astro";
import { getCollection } from "astro:content";

// ðŸ”¹ Carrega todos os posts do tipo "blog"
const posts = await getCollection("blog");

// ðŸ”¹ Extrai as categorias Ãºnicas
const categories = [
  ...new Set(
    posts
      .map(p => p.data.category)
      .filter(Boolean)
      .map(c => c.trim())
  )
];

// ðŸ”¹ Idiomas suportados
const labels = {
  en: { title: "Categories", none: "No categories found." },
  es: { title: "CategorÃ­as", none: "No se encontraron categorÃ­as." },
  pt: { title: "Categorias", none: "Nenhuma categoria encontrada." },
};

// ðŸ”¹ Escolhe idioma (ajusta manualmente ou via automaÃ§Ã£o)
const lang = "pt"; // "en", "es" ou "pt"
const L = labels[lang] || labels.en;
---

<Base title={L.title}>
  <section style="padding: 2rem;">
    <h1 style="text-align:center;">{L.title}</h1>

    {categories.length === 0 ? (
      <p style="text-align:center;">{L.none}</p>
    ) : (
      <ul
        style="
          list-style:none;
          display:flex;
          flex-wrap:wrap;
          gap:1rem;
          justify-content:center;
          margin-top:2rem;
        "
      >
        {categories.map(cat => (
          <li>
            <a
              href={`/categories/${cat.toLowerCase().replace(/\s+/g, "-")}/`}
              style="text-decoration:none;color:var(--accent);font-weight:600;"
            >
              {cat}
            </a>
          </li>
        ))}
      </ul>
    )}
  </section>
</Base>
